{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.215.0"},"children":{"CoreStack":{"id":"CoreStack","path":"CoreStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.215.0"},"children":{"CoreVpc":{"id":"CoreVpc","path":"CoreStack/CoreVpc","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"CoreStack/CoreVpc"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"CoreStack/CoreVpc/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.215.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"CoreStack/CoreVpc/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.0.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"Acl":{"id":"Acl","path":"CoreStack/CoreVpc/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"CoreStack/CoreVpc/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"CoreStack/CoreVpc/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"CoreVpcPublicSubnet1RouteTable697D2E7A"},"subnetId":{"Ref":"CoreVpcPublicSubnet1SubnetBFAB563C"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"CoreStack/CoreVpc/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"CoreVpcIGWC3C68BEA"},"routeTableId":{"Ref":"CoreVpcPublicSubnet1RouteTable697D2E7A"}}}},"EIP":{"id":"EIP","path":"CoreStack/CoreVpc/PublicSubnet1/EIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet1"}]}}},"NATGateway":{"id":"NATGateway","path":"CoreStack/CoreVpc/PublicSubnet1/NATGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["CoreVpcPublicSubnet1EIP66768B4F","AllocationId"]},"subnetId":{"Ref":"CoreVpcPublicSubnet1SubnetBFAB563C"},"tags":[{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet1"}]}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"CoreStack/CoreVpc/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.215.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"CoreStack/CoreVpc/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.64.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet2"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"Acl":{"id":"Acl","path":"CoreStack/CoreVpc/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"CoreStack/CoreVpc/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc/PublicSubnet2"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"CoreStack/CoreVpc/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"CoreVpcPublicSubnet2RouteTableDE77D4A5"},"subnetId":{"Ref":"CoreVpcPublicSubnet2Subnet394BC44D"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"CoreStack/CoreVpc/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"CoreVpcIGWC3C68BEA"},"routeTableId":{"Ref":"CoreVpcPublicSubnet2RouteTableDE77D4A5"}}}}}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"CoreStack/CoreVpc/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.215.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"CoreStack/CoreVpc/PrivateSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.128.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"CoreStack/CoreVpc/PrivateSubnet1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"Acl":{"id":"Acl","path":"CoreStack/CoreVpc/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"CoreStack/CoreVpc/PrivateSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc/PrivateSubnet1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"CoreStack/CoreVpc/PrivateSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"CoreVpcPrivateSubnet1RouteTableA2DA400B"},"subnetId":{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"CoreStack/CoreVpc/PrivateSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"CoreVpcPublicSubnet1NATGateway48D9585E"},"routeTableId":{"Ref":"CoreVpcPrivateSubnet1RouteTableA2DA400B"}}}}}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"CoreStack/CoreVpc/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.215.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"CoreStack/CoreVpc/PrivateSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.192.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"CoreStack/CoreVpc/PrivateSubnet2"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"Acl":{"id":"Acl","path":"CoreStack/CoreVpc/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"CoreStack/CoreVpc/PrivateSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc/PrivateSubnet2"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"CoreStack/CoreVpc/PrivateSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"CoreVpcPrivateSubnet2RouteTable338D48D1"},"subnetId":{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"CoreStack/CoreVpc/PrivateSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"CoreVpcPublicSubnet1NATGateway48D9585E"},"routeTableId":{"Ref":"CoreVpcPrivateSubnet2RouteTable338D48D1"}}}}}},"IGW":{"id":"IGW","path":"CoreStack/CoreVpc/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc"}]}}},"VPCGW":{"id":"VPCGW","path":"CoreStack/CoreVpc/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"CoreVpcIGWC3C68BEA"},"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"S3Endpoint":{"id":"S3Endpoint","path":"CoreStack/CoreVpc/S3Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.GatewayVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreVpc/S3Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc"}],"routeTableIds":[{"Ref":"CoreVpcPrivateSubnet1RouteTableA2DA400B"},{"Ref":"CoreVpcPrivateSubnet2RouteTable338D48D1"},{"Ref":"CoreVpcPublicSubnet1RouteTable697D2E7A"},{"Ref":"CoreVpcPublicSubnet2RouteTableDE77D4A5"}],"serviceName":{"Fn::Join":["",["com.amazonaws.",{"Ref":"AWS::Region"},".s3"]]},"vpcEndpointType":"Gateway","vpcId":{"Ref":"CoreVpcB2509D56"}}}}}},"SecretsManagerEndpoint":{"id":"SecretsManagerEndpoint","path":"CoreStack/CoreVpc/SecretsManagerEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreVpc/SecretsManagerEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.secretsmanager","subnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"CoreVpcB2509D56"}}}}}},"LogsEndpoint":{"id":"LogsEndpoint","path":"CoreStack/CoreVpc/LogsEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreVpc/LogsEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.logs","subnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"CoreVpcB2509D56"}}}}}},"ApiGatewayEndpoint":{"id":"ApiGatewayEndpoint","path":"CoreStack/CoreVpc/ApiGatewayEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreVpc/ApiGatewayEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"CoreStack/CoreVpc"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.execute-api","subnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"CoreVpcB2509D56"}}}}}}}},"CoreLambdaSg":{"id":"CoreLambdaSg","path":"CoreStack/CoreLambdaSg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreLambdaSg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"CoreStack/CoreLambdaSg","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["CoreVpcB2509D56","CidrBlock"]},"ipProtocol":"tcp","fromPort":443,"toPort":443,"description":{"Fn::Join":["",["from ",{"Fn::GetAtt":["CoreVpcB2509D56","CidrBlock"]},":443"]]}}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}}}},"CoreDbSg":{"id":"CoreDbSg","path":"CoreStack/CoreDbSg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDbSg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"CoreStack/CoreDbSg","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"from CoreStackCoreProxySg8301D32F:{IndirectPort}":{"id":"from CoreStackCoreProxySg8301D32F:{IndirectPort}","path":"CoreStack/CoreDbSg/from CoreStackCoreProxySg8301D32F:{IndirectPort}","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow connections to the database Instance from the Proxy","fromPort":{"Fn::GetAtt":["CoreDbE4DEAC87","Endpoint.Port"]},"groupId":{"Fn::GetAtt":["CoreDbSg075192C3","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["CoreProxySgC71AB68A","GroupId"]},"toPort":{"Fn::GetAtt":["CoreDbE4DEAC87","Endpoint.Port"]}}}},"from CoreStackCoreProxySg8301D32F:5432":{"id":"from CoreStackCoreProxySg8301D32F:5432","path":"CoreStack/CoreDbSg/from CoreStackCoreProxySg8301D32F:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"from CoreStackCoreProxySg8301D32F:5432","fromPort":5432,"groupId":{"Fn::GetAtt":["CoreDbSg075192C3","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["CoreProxySgC71AB68A","GroupId"]},"toPort":5432}}}}},"CoreProxySg":{"id":"CoreProxySg","path":"CoreStack/CoreProxySg","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreProxySg/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"CoreStack/CoreProxySg","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}},"from CoreStackCoreLambdaSg443C0DCD:5432":{"id":"from CoreStackCoreLambdaSg443C0DCD:5432","path":"CoreStack/CoreProxySg/from CoreStackCoreLambdaSg443C0DCD:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"from CoreStackCoreLambdaSg443C0DCD:5432","fromPort":5432,"groupId":{"Fn::GetAtt":["CoreProxySgC71AB68A","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]},"toPort":5432}}}}},"CoreDbSecret":{"id":"CoreDbSecret","path":"CoreStack/CoreDbSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.DatabaseSecret","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDbSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":{"Fn::Join":["",["Generated by the CDK for stack: ",{"Ref":"AWS::StackName"}]]},"generateSecretString":{"passwordLength":30,"secretStringTemplate":"{\"username\":\"coreuser\"}","generateStringKey":"password","excludeCharacters":" %+~`#$&*()|[]{}:;<>?!'/@\"\\"}}}},"Attachment":{"id":"Attachment","path":"CoreStack/CoreDbSecret/Attachment","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.SecretTargetAttachment","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDbSecret/Attachment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecretTargetAttachment","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::SecretTargetAttachment","aws:cdk:cloudformation:props":{"secretId":{"Ref":"CoreDbSecretA1369E69"},"targetId":{"Ref":"CoreDbE4DEAC87"},"targetType":"AWS::RDS::DBInstance"}}}}},"CoreDbRotation":{"id":"CoreDbRotation","path":"CoreStack/CoreDbSecret/CoreDbRotation","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.RotationSchedule","version":"2.215.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"CoreStack/CoreDbSecret/CoreDbRotation/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDbSecret/CoreDbRotation/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"CoreStack/CoreDbSecret/CoreDbRotation/SecurityGroup","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"CoreVpcB2509D56"}}}}}},"Resource":{"id":"Resource","path":"CoreStack/CoreDbSecret/CoreDbRotation/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnRotationSchedule","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::RotationSchedule","aws:cdk:cloudformation:props":{"hostedRotationLambda":{"rotationType":"PostgreSQLSingleUser","vpcSecurityGroupIds":{"Fn::GetAtt":["CoreDbSecretCoreDbRotationSecurityGroup62DD6311","GroupId"]},"vpcSubnetIds":{"Fn::Join":["",[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},",",{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]]},"excludeCharacters":" %+~`#$&*()|[]{}:;<>?!'/@\"\\"},"rotationRules":{"scheduleExpression":"rate(30 days)"},"secretId":{"Ref":"CoreDbSecretA1369E69"}}}}}},"Policy":{"id":"Policy","path":"CoreStack/CoreDbSecret/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.ResourcePolicy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDbSecret/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnResourcePolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::ResourcePolicy","aws:cdk:cloudformation:props":{"resourcePolicy":{"Statement":[{"Action":"secretsmanager:DeleteSecret","Effect":"Deny","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::111111111111:root"]]}},"Resource":"*"}],"Version":"2012-10-17"},"secretId":{"Ref":"CoreDbSecretA1369E69"}}}}}}}},"CoreDb":{"id":"CoreDb","path":"CoreStack/CoreDb","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.DatabaseInstance","version":"2.215.0","metadata":[]},"children":{"SubnetGroup":{"id":"SubnetGroup","path":"CoreStack/CoreDb/SubnetGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.SubnetGroup","version":"2.215.0","metadata":[]},"children":{"Default":{"id":"Default","path":"CoreStack/CoreDb/SubnetGroup/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBSubnetGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBSubnetGroup","aws:cdk:cloudformation:props":{"dbSubnetGroupDescription":"Subnet group for CoreDb database","subnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]}}}}},"Resource":{"id":"Resource","path":"CoreStack/CoreDb/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBInstance","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBInstance","aws:cdk:cloudformation:props":{"allocatedStorage":"100","copyTagsToSnapshot":true,"dbInstanceClass":"db.m5.large","dbSubnetGroupName":{"Ref":"CoreDbSubnetGroup3923B79B"},"engine":"postgres","engineVersion":"16.3","masterUsername":{"Fn::Join":["",["{{resolve:secretsmanager:",{"Ref":"CoreDbSecretA1369E69"},":SecretString:username::}}"]]},"masterUserPassword":{"Fn::Join":["",["{{resolve:secretsmanager:",{"Ref":"CoreDbSecretA1369E69"},":SecretString:password::}}"]]},"multiAz":false,"publiclyAccessible":false,"storageType":"gp2","vpcSecurityGroups":[{"Fn::GetAtt":["CoreDbSg075192C3","GroupId"]}]}}},"CoreDbProxy":{"id":"CoreDbProxy","path":"CoreStack/CoreDb/CoreDbProxy","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.DatabaseProxy","version":"2.215.0","metadata":[]},"children":{"IAMRole":{"id":"IAMRole","path":"CoreStack/CoreDb/CoreDbProxy/IAMRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportIAMRole":{"id":"ImportIAMRole","path":"CoreStack/CoreDb/CoreDbProxy/IAMRole/ImportIAMRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/CoreDb/CoreDbProxy/IAMRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"rds.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoreStack/CoreDb/CoreDbProxy/IAMRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreDb/CoreDbProxy/IAMRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"CoreDbSecretA1369E69"}}],"Version":"2012-10-17"},"policyName":"CoreDbCoreDbProxyIAMRoleDefaultPolicy0A80926D","roles":[{"Ref":"CoreDbCoreDbProxyIAMRoleA20BC709"}]}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/CoreDb/CoreDbProxy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBProxy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBProxy","aws:cdk:cloudformation:props":{"auth":[{"authScheme":"SECRETS","iamAuth":"DISABLED","secretArn":{"Ref":"CoreDbSecretA1369E69"}}],"dbProxyName":"CoreDbProxy","engineFamily":"POSTGRESQL","requireTls":true,"roleArn":{"Fn::GetAtt":["CoreDbCoreDbProxyIAMRoleA20BC709","Arn"]},"vpcSecurityGroupIds":[{"Fn::GetAtt":["CoreProxySgC71AB68A","GroupId"]}],"vpcSubnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]}}},"ProxyTargetGroup":{"id":"ProxyTargetGroup","path":"CoreStack/CoreDb/CoreDbProxy/ProxyTargetGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_rds.CfnDBProxyTargetGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::RDS::DBProxyTargetGroup","aws:cdk:cloudformation:props":{"connectionPoolConfigurationInfo":{},"dbInstanceIdentifiers":[{"Ref":"CoreDbE4DEAC87"}],"dbProxyName":{"Ref":"CoreDbCoreDbProxy97F0332B"},"targetGroupName":"default"}}}}}}},"CoreGatewayFn":{"id":"CoreGatewayFn","path":"CoreStack/CoreGatewayFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.215.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CoreStack/CoreGatewayFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CoreStack/CoreGatewayFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoreStack/CoreGatewayFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"CoreDbSecretA1369E69"}},{"Action":"rds-db:connect","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":rds-db:us-east-1:111111111111:dbuser:",{"Fn::Select":[6,{"Fn::Split":[":",{"Fn::GetAtt":["CoreDbCoreDbProxy97F0332B","DBProxyArn"]}]}]},"/coreuser"]]}}],"Version":"2012-10-17"},"policyName":"CoreGatewayFnServiceRoleDefaultPolicy42B9029D","roles":[{"Ref":"CoreGatewayFnServiceRole34C0306D"}]}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"exports.handler=async()=>({statusCode:200,body:\"ok\"});"},"environment":{"variables":{"DATABASE_HOST":{"Fn::GetAtt":["CoreDbCoreDbProxy97F0332B","Endpoint"]},"DB_SECRET_ARN":{"Ref":"CoreDbSecretA1369E69"}}},"handler":"index.handler","role":{"Fn::GetAtt":["CoreGatewayFnServiceRole34C0306D","Arn"]},"runtime":"nodejs18.x","vpcConfig":{"subnetIds":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}]}}}}}},"CoreUserPool":{"id":"CoreUserPool","path":"CoreStack/CoreUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1},{"name":"verified_email","priority":2}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":true},"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"CoreUserPoolClient":{"id":"CoreUserPoolClient","path":"CoreStack/CoreUserPool/CoreUserPoolClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreUserPool/CoreUserPoolClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"supportedIdentityProviders":["COGNITO"],"userPoolId":{"Ref":"CoreUserPoolD16FE657"}}}}}}}},"CoreAuthorizer":{"id":"CoreAuthorizer","path":"CoreStack/CoreAuthorizer","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CognitoUserPoolsAuthorizer","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreAuthorizer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAuthorizer","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Authorizer","aws:cdk:cloudformation:props":{"identitySource":"method.request.header.Authorization","name":"CoreStackCoreAuthorizer5C839081","providerArns":[{"Fn::GetAtt":["CoreUserPoolD16FE657","Arn"]}],"restApiId":{"Ref":"CoreGatewayApiE57B3CE7"},"type":"COGNITO_USER_POOLS"}}}}},"CoreGatewayApi":{"id":"CoreGatewayApi","path":"CoreStack/CoreGatewayApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"name":"CoreGatewayApi"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"CoreStack/CoreGatewayApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"CoreStack/CoreGatewayApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"CoreStack/CoreGatewayApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["CoreGatewayApiCloudWatchRoleCED2746F","Arn"]}}}},"Deployment":{"id":"Deployment","path":"CoreStack/CoreGatewayApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Automatically created by the RestApi construct","restApiId":{"Ref":"CoreGatewayApiE57B3CE7"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"CoreStack/CoreGatewayApi/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"CoreGatewayApiDeploymentB625465D48201d317725d9830342241f3e2b2ef8"},"restApiId":{"Ref":"CoreGatewayApiE57B3CE7"},"stageName":"prod"}}}}},"Endpoint":{"id":"Endpoint","path":"CoreStack/CoreGatewayApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"Default":{"id":"Default","path":"CoreStack/CoreGatewayApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.215.0","metadata":[]},"children":{"{proxy+}":{"id":"{proxy+}","path":"CoreStack/CoreGatewayApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["CoreGatewayApiE57B3CE7","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"CoreGatewayApiE57B3CE7"}}}},"ANY":{"id":"ANY","path":"CoreStack/CoreGatewayApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.215.0","metadata":[]},"children":{"ApiPermission.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}":{"id":"ApiPermission.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}","path":"CoreStack/CoreGatewayApi/Default/{proxy+}/ANY/ApiPermission.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["CoreGatewayFnCF38CCB6","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:111111111111:",{"Ref":"CoreGatewayApiE57B3CE7"},"/",{"Ref":"CoreGatewayApiDeploymentStageprod054CB900"},"/*/*"]]}}}},"ApiPermission.Test.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}":{"id":"ApiPermission.Test.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}","path":"CoreStack/CoreGatewayApi/Default/{proxy+}/ANY/ApiPermission.Test.CoreStackCoreGatewayApi1097126C.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["CoreGatewayFnCF38CCB6","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:111111111111:",{"Ref":"CoreGatewayApiE57B3CE7"},"/test-invoke-stage/*/*"]]}}}},"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"COGNITO_USER_POOLS","authorizerId":{"Ref":"CoreAuthorizerAB99A484"},"httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["CoreGatewayFnCF38CCB6","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"CoreGatewayApiproxyF4EFA72B"},"restApiId":{"Ref":"CoreGatewayApiE57B3CE7"}}}}}}}},"ANY":{"id":"ANY","path":"CoreStack/CoreGatewayApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreGatewayApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"COGNITO_USER_POOLS","authorizerId":{"Ref":"CoreAuthorizerAB99A484"},"httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["CoreGatewayApiE57B3CE7","RootResourceId"]},"restApiId":{"Ref":"CoreGatewayApiE57B3CE7"}}}}}}}}}},"CoreQueue":{"id":"CoreQueue","path":"CoreStack/CoreQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{}}}}},"CoreBucket":{"id":"CoreBucket","path":"CoreStack/CoreBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/CoreBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{}}}}},"OpenApiBucket":{"id":"OpenApiBucket","path":"CoreStack/OpenApiBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/OpenApiBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"CoreStack/OpenApiBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/OpenApiBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"OpenApiBucket2F7F7D8D"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OpenApiDistributionOrigin1S3Origin7E486E35","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["OpenApiBucket2F7F7D8D","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OpenApiDistribution":{"id":"OpenApiDistribution","path":"CoreStack/OpenApiDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.215.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"CoreStack/OpenApiDistribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"S3Origin":{"id":"S3Origin","path":"CoreStack/OpenApiDistribution/Origin1/S3Origin","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/OpenApiDistribution/Origin1/S3Origin/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Identity for CoreStackOpenApiDistributionOrigin1A79E2CD4"}}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/OpenApiDistribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["OpenApiBucket2F7F7D8D","RegionalDomainName"]},"id":"CoreStackOpenApiDistributionOrigin1A79E2CD4","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OpenApiDistributionOrigin1S3Origin7E486E35"}]]}}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"CoreStackOpenApiDistributionOrigin1A79E2CD4","cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"allow-all"},"httpVersion":"http2","ipv6Enabled":true}}}}}},"FrontendBucket":{"id":"FrontendBucket","path":"CoreStack/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"websiteConfiguration":{"indexDocument":"index.html"}}}}}},"FrontendDistribution":{"id":"FrontendDistribution","path":"CoreStack/FrontendDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.215.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"CoreStack/FrontendDistribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Resource":{"id":"Resource","path":"CoreStack/FrontendDistribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::GetAtt":["FrontendBucketEFE2E19C","WebsiteURL"]}]}]},"id":"CoreStackFrontendDistributionOrigin1CA46BCEB","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"http-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"CoreStackFrontendDistributionOrigin1CA46BCEB","cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true}}}}}},"DbMigrateProject":{"id":"DbMigrateProject","path":"CoreStack/DbMigrateProject","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.215.0","metadata":[]},"children":{"Role":{"id":"Role","path":"CoreStack/DbMigrateProject/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"CoreStack/DbMigrateProject/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/DbMigrateProject/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoreStack/DbMigrateProject/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/DbMigrateProject/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"ec2:CreateNetworkInterfacePermission","Condition":{"StringEquals":{"ec2:Subnet":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]]}],"ec2:AuthorizedService":"codebuild.amazonaws.com"}},"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":network-interface/*"]]}},{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"DbMigrateProjectE6A46868"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"DbMigrateProjectE6A46868"},":*"]]}]},{"Action":["codebuild:CreateReportGroup","codebuild:CreateReport","codebuild:UpdateReport","codebuild:BatchPutTestCases","codebuild:BatchPutCodeCoverages"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:us-east-1:111111111111:report-group/",{"Ref":"DbMigrateProjectE6A46868"},"-*"]]}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"CoreDbSecretA1369E69"}}],"Version":"2012-10-17"},"policyName":"DbMigrateProjectRoleDefaultPolicy716257FB","roles":[{"Ref":"DbMigrateProjectRole37C0A3B1"}]}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/DbMigrateProject/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":false,"computeType":"BUILD_GENERAL1_SMALL","environmentVariables":[{"name":"DB_SECRET_ARN","type":"PLAINTEXT","value":{"Ref":"CoreDbSecretA1369E69"}},{"name":"DATABASE_HOST","type":"PLAINTEXT","value":{"Fn::GetAtt":["CoreDbCoreDbProxy97F0332B","Endpoint"]}}]},"name":"db-migrate","serviceRole":{"Fn::GetAtt":["DbMigrateProjectRole37C0A3B1","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"install\": {\n      \"commands\": [\n        \"yum install -y jq\",\n        \"pnpm install --frozen-lockfile\"\n      ]\n    },\n    \"build\": {\n      \"commands\": [\n        \"SECRET=$(aws secretsmanager get-secret-value --secret-id $DB_SECRET_ARN --query SecretString --output text)\",\n        \"USER=$(echo $SECRET | jq -r .username)\",\n        \"PASS=$(echo $SECRET | jq -r .password)\",\n        \"export DATABASE_URL=\\\"postgresql://$USER:$PASS@$DATABASE_HOST:5432/postgres\\\"\",\n        \"npx prisma migrate deploy --schema packages/db/prisma/schema.prisma\"\n      ]\n    }\n  }\n}"},"vpcConfig":{"vpcId":{"Ref":"CoreVpcB2509D56"},"subnets":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}]}}}},"PolicyDocument":{"id":"PolicyDocument","path":"CoreStack/DbMigrateProject/PolicyDocument","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/DbMigrateProject/PolicyDocument/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ec2:CreateNetworkInterface","ec2:DescribeNetworkInterfaces","ec2:DeleteNetworkInterface","ec2:DescribeSubnets","ec2:DescribeSecurityGroups","ec2:DescribeDhcpOptions","ec2:DescribeVpcs"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"DbMigrateProjectPolicyDocument659E76B4","roles":[{"Ref":"DbMigrateProjectRole37C0A3B1"}]}}}}}}},"OpenApiPublishProject":{"id":"OpenApiPublishProject","path":"CoreStack/OpenApiPublishProject","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.215.0","metadata":[]},"children":{"Role":{"id":"Role","path":"CoreStack/OpenApiPublishProject/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"CoreStack/OpenApiPublishProject/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/OpenApiPublishProject/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoreStack/OpenApiPublishProject/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/OpenApiPublishProject/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"ec2:CreateNetworkInterfacePermission","Condition":{"StringEquals":{"ec2:Subnet":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]]}],"ec2:AuthorizedService":"codebuild.amazonaws.com"}},"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":network-interface/*"]]}},{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"OpenApiPublishProject1F03FE64"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"OpenApiPublishProject1F03FE64"},":*"]]}]},{"Action":["codebuild:CreateReportGroup","codebuild:CreateReport","codebuild:UpdateReport","codebuild:BatchPutTestCases","codebuild:BatchPutCodeCoverages"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:us-east-1:111111111111:report-group/",{"Ref":"OpenApiPublishProject1F03FE64"},"-*"]]}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["OpenApiBucket2F7F7D8D","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["OpenApiBucket2F7F7D8D","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"OpenApiPublishProjectRoleDefaultPolicyCE3A78F1","roles":[{"Ref":"OpenApiPublishProjectRole0B3BCC3F"}]}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/OpenApiPublishProject/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":false,"computeType":"BUILD_GENERAL1_SMALL","environmentVariables":[{"name":"OPENAPI_BUCKET","type":"PLAINTEXT","value":{"Ref":"OpenApiBucket2F7F7D8D"}}]},"name":"openapi-publish","serviceRole":{"Fn::GetAtt":["OpenApiPublishProjectRole0B3BCC3F","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"install\": {\n      \"commands\": [\n        \"pnpm install --frozen-lockfile\"\n      ]\n    },\n    \"build\": {\n      \"commands\": [\n        \"pnpm --filter @sevens/core-gateway run openapi\",\n        \"aws s3 cp apps/core-gateway/openapi.json s3://$OPENAPI_BUCKET/openapi.json\"\n      ]\n    }\n  }\n}"},"vpcConfig":{"vpcId":{"Ref":"CoreVpcB2509D56"},"subnets":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}]}}}},"PolicyDocument":{"id":"PolicyDocument","path":"CoreStack/OpenApiPublishProject/PolicyDocument","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/OpenApiPublishProject/PolicyDocument/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ec2:CreateNetworkInterface","ec2:DescribeNetworkInterfaces","ec2:DeleteNetworkInterface","ec2:DescribeSubnets","ec2:DescribeSecurityGroups","ec2:DescribeDhcpOptions","ec2:DescribeVpcs"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"OpenApiPublishProjectPolicyDocumentE310A21F","roles":[{"Ref":"OpenApiPublishProjectRole0B3BCC3F"}]}}}}}}},"FrontendPublishProject":{"id":"FrontendPublishProject","path":"CoreStack/FrontendPublishProject","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.215.0","metadata":[]},"children":{"Role":{"id":"Role","path":"CoreStack/FrontendPublishProject/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"CoreStack/FrontendPublishProject/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"CoreStack/FrontendPublishProject/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CoreStack/FrontendPublishProject/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/FrontendPublishProject/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"ec2:CreateNetworkInterfacePermission","Condition":{"StringEquals":{"ec2:Subnet":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}]]}],"ec2:AuthorizedService":"codebuild.amazonaws.com"}},"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":network-interface/*"]]}},{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"FrontendPublishProject4C74BFD1"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:111111111111:log-group:/aws/codebuild/",{"Ref":"FrontendPublishProject4C74BFD1"},":*"]]}]},{"Action":["codebuild:CreateReportGroup","codebuild:CreateReport","codebuild:UpdateReport","codebuild:BatchPutTestCases","codebuild:BatchPutCodeCoverages"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:us-east-1:111111111111:report-group/",{"Ref":"FrontendPublishProject4C74BFD1"},"-*"]]}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"FrontendPublishProjectRoleDefaultPolicy3D3EA22C","roles":[{"Ref":"FrontendPublishProjectRoleD7715754"}]}}}}}}},"Resource":{"id":"Resource","path":"CoreStack/FrontendPublishProject/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":false,"computeType":"BUILD_GENERAL1_SMALL","environmentVariables":[{"name":"FRONTEND_BUCKET","type":"PLAINTEXT","value":{"Ref":"FrontendBucketEFE2E19C"}},{"name":"VITE_API_BASE","type":"PLAINTEXT","value":{"Fn::Join":["",["https://",{"Ref":"CoreGatewayApiE57B3CE7"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"},"/",{"Ref":"CoreGatewayApiDeploymentStageprod054CB900"},"/"]]}}]},"name":"frontend-publish","serviceRole":{"Fn::GetAtt":["FrontendPublishProjectRoleD7715754","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"install\": {\n      \"commands\": [\n        \"pnpm install --frozen-lockfile\"\n      ]\n    },\n    \"build\": {\n      \"commands\": [\n        \"pnpm run build\",\n        \"aws s3 sync dist s3://$FRONTEND_BUCKET/ --delete\"\n      ]\n    }\n  }\n}"},"vpcConfig":{"vpcId":{"Ref":"CoreVpcB2509D56"},"subnets":[{"Ref":"CoreVpcPrivateSubnet1Subnet30A154AF"},{"Ref":"CoreVpcPrivateSubnet2SubnetE1E23F29"}],"securityGroupIds":[{"Fn::GetAtt":["CoreLambdaSg20A61E1C","GroupId"]}]}}}},"PolicyDocument":{"id":"PolicyDocument","path":"CoreStack/FrontendPublishProject/PolicyDocument","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CoreStack/FrontendPublishProject/PolicyDocument/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ec2:CreateNetworkInterface","ec2:DescribeNetworkInterfaces","ec2:DeleteNetworkInterface","ec2:DescribeSubnets","ec2:DescribeSecurityGroups","ec2:DescribeDhcpOptions","ec2:DescribeVpcs"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"FrontendPublishProjectPolicyDocumentFC5943F7","roles":[{"Ref":"FrontendPublishProjectRoleD7715754"}]}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"CoreStack/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"DbInstanceArn":{"id":"DbInstanceArn","path":"CoreStack/DbInstanceArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"RdsProxyEndpoint":{"id":"RdsProxyEndpoint","path":"CoreStack/RdsProxyEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"QueueArn":{"id":"QueueArn","path":"CoreStack/QueueArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"BucketArn":{"id":"BucketArn","path":"CoreStack/BucketArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"DbMigrateProjectName":{"id":"DbMigrateProjectName","path":"CoreStack/DbMigrateProjectName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"OpenApiUrl":{"id":"OpenApiUrl","path":"CoreStack/OpenApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"OpenApiPublishProjectName":{"id":"OpenApiPublishProjectName","path":"CoreStack/OpenApiPublishProjectName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"FrontendUrl":{"id":"FrontendUrl","path":"CoreStack/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"FrontendPublishProjectName":{"id":"FrontendPublishProjectName","path":"CoreStack/FrontendPublishProjectName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CoreStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"CoreStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CoreStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.215.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CoreStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.215.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}