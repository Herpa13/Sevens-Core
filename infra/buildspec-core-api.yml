version: 0.2

phases:
  install:
    commands:
      - corepack enable
      - corepack prepare yarn@4.9.4 --activate
      - yarn config set nodeLinker node-modules
      # instalamos dependencias en modo producci√≥n para core-gateway
      - yarn workspaces focus @sevens/core-gateway --production
  pre_build:
    commands:
      - echo "Pre-build phase (opcional: tests, lint, etc)"
  build:
    commands:
      - cd apps/core-gateway
      - yarn build
      - cd ../..
      # empaquetamos dist, node_modules reducido y package.json
      - zip -r core-gateway.zip apps/core-gateway/dist node_modules apps/core-gateway/package.json
artifacts:
  files:
    - core-gateway.zip

